# COCO2017_Body_Detection

迭代日志：

**v1.0** 

利用COCO2017的关键点标注(左右肩部，左右臀部)来实现对人体的上半身进行检测，只需要在 COCO 标注中找到四个人体关键点，然后做一个最小的包被矩形，并且扩大一个 scale。注意关键点如果被遮挡的话标注就是 1， 没有标注关键点的话就是 0，至于被遮挡的关键点要还是不要就都可以试下，我最后的方案是：找不到四个关键点的话（也就是有一个以上关键点没有标注）就放弃这个目标，被遮挡的情况下也将目标当成正样本。



**v1.1**

在以上的基础上将四张图拼接成一张图，我将图片的最长边设置为 416，将原始的 COCO 数据集 resize 到这个尺寸不改变原来的比例，空白的地方用 RGB 颜色进行填充，这样的话在一张图上面的目标就相对多了，可以加强训练效果，相当于一种数据增强。



**v2.0**

原始的这种方法，因为有些目标缺失关键点，所以就被当成了负样本，并且这样会漏掉许多正常的目标，不过据师兄说，这一版训出来的效果是最好的 ==。然后甲方提出新的要求，必须要在人体的标注中出现手和头，然后一种办法就是仍然通过关键点来进行标注，这次额外用了四个点：左右肘和左右手腕，同样是用一个最小的包被矩形将关键点给包被起来，然后对矩形上方扩大一个更大的 scale，以将头部给包含进矩形。



**v2.1**

这种方法利用 COCO 本来自带的 BBox 人体标注配合上关键点标注，因为 BBox 已经将整个人给包含了进去，所以标注的 Box 上限已经确定好，我们就只需要确定下界就行了，开始想的是简单地用双臀的点将 BBox 给截断，后来可视化之后发现很多样本的手在臀部之下，所以要利用关键点之间的位置确定好最下面的一个点，然后再将 BBox 给截断。



**v2.2**

参照 **v1.1** 版本，并且更简单，这个版本用的是全身的标注，也就是直接用 BBox 进行标注，为了更好地模拟人脸关键点的分布，采用双膝盖的关键点代替了双臀



**v3.0**

**v2** 版本训出来效果不好，猜测是因为训练的时候包含了头部进去，和人脸检测的训练互相影响，因此这一版做个消融实验，只将手部包含进去，不包含头部，也就是，用 **v1** 版本的策略，同时加上四个手部的关键点，用一个 BBox 将手给包含进去就行了，不过要细心点，会有很多特例和容易出现的 bug，特别是四张图拼接在一起，很容易出现标注越界的情况 ==



## pipeline

![pipeline](https://i.loli.net/2020/08/05/zr2eC5IuKhbWOXa.png)

## demo

![coco_viz_1108.jpg](https://i.loli.net/2020/08/05/umLH71hYyQXUcGB.jpg)
![coco_viz_328.jpg](https://i.loli.net/2020/08/05/YdUSXqNoPiRcyGC.jpg)
![coco_viz_962.jpg](https://i.loli.net/2020/08/05/iwC4xjJ2qIdRgns.jpg)